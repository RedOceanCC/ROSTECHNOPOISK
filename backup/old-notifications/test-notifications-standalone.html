<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–≤—Ç–æ–Ω–æ–º–Ω—ã–π —Ç–µ—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π - –†–û–°–¢–ï–•–ù–û–ü–û–ò–°–ö</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background: #f8f9fa;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-result { 
            padding: 12px; 
            margin: 8px 0; 
            border-radius: 6px; 
            border-left: 4px solid;
            font-family: monospace;
            font-size: 14px;
        }
        .success { 
            background: #d4edda; 
            border-left-color: #28a745; 
            color: #155724; 
        }
        .error { 
            background: #f8d7da; 
            border-left-color: #dc3545; 
            color: #721c24; 
        }
        .info { 
            background: #d1ecf1; 
            border-left-color: #17a2b8; 
            color: #0c5460; 
        }
        .warning {
            background: #fff3cd;
            border-left-color: #ffc107;
            color: #856404;
        }
        .test-controls { 
            margin: 20px 0; 
            text-align: center;
        }
        .btn { 
            padding: 12px 20px; 
            margin: 8px; 
            border: none; 
            border-radius: 6px; 
            cursor: pointer; 
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
        }
        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .btn-primary { 
            background: #007bff; 
            color: white; 
        }
        .btn-secondary { 
            background: #6c757d; 
            color: white; 
        }
        .btn-success {
            background: #28a745;
            color: white;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }
        .stat-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            text-align: center;
            border: 1px solid #dee2e6;
        }
        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #495057;
        }
        .stat-label {
            font-size: 12px;
            color: #6c757d;
            text-transform: uppercase;
        }
        #test-results {
            max-height: 500px;
            overflow-y: auto;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 10px;
            background: #ffffff;
        }
        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e9ecef;
            border-radius: 3px;
            margin: 10px 0;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: #007bff;
            transition: width 0.3s ease;
            width: 0%;
        }
        .server-info {
            background: #e3f2fd;
            border: 1px solid #bbdefb;
            border-radius: 6px;
            padding: 15px;
            margin: 20px 0;
        }
        .server-info h3 {
            margin: 0 0 10px 0;
            color: #1976d2;
        }
        .code-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 12px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            margin: 10px 0;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ –ê–≤—Ç–æ–Ω–æ–º–Ω—ã–π —Ç–µ—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π - –†–û–°–¢–ï–•–ù–û–ü–û–ò–°–ö</h1>
        
        <div class="server-info">
            <h3>‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ file://</h3>
            <p>–≠—Ç–æ—Ç —Ñ–∞–π–ª –æ—Ç–∫—Ä—ã—Ç –∫–∞–∫ –ª–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª. –î–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω—É–∂–Ω–æ:</p>
            <div class="code-block">
                1. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞: cp test-notifications-standalone.html ../<br>
                2. –û—Ç–∫—Ä—ã—Ç—å —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–µ—Ä: https://—Ä–æ—Å—Ç–µ—Ö–Ω–æ–ø–æ–∏—Å–∫.—Ä—Ñ/test-notifications-standalone.html<br>
                3. –ò–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ: http://localhost:3000/test-notifications-standalone.html
            </div>
        </div>
        
        <div class="test-controls">
            <button class="btn btn-primary" onclick="runStandaloneTests()" id="runTestsBtn">
                üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–µ —Ç–µ—Å—Ç—ã
            </button>
            <button class="btn btn-secondary" onclick="clearResults()">
                üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            </button>
            <button class="btn btn-success" onclick="testToastNotification()">
                üîî –¢–µ—Å—Ç Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
            </button>
        </div>
        
        <div class="progress-bar">
            <div class="progress-fill" id="progressBar"></div>
        </div>
        
        <div class="stats" id="testStats">
            <div class="stat-card">
                <div class="stat-number" id="totalTests">0</div>
                <div class="stat-label">–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="passedTests">0</div>
                <div class="stat-label">–ü—Ä–æ–π–¥–µ–Ω–æ</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="failedTests">0</div>
                <div class="stat-label">–û—à–∏–±–æ–∫</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="warningTests">0</div>
                <div class="stat-label">–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π</div>
            </div>
        </div>
        
        <div id="test-results"></div>
    </div>
    
    <!-- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —É–ø—Ä–æ—â–µ–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
    <script>
        // –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è NotificationManager –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        class TestNotificationManager {
            constructor() {
                this.notifications = [];
                this.maxNotifications = 5;
                this.defaultDuration = 4000;
                this.container = null;
                this.init();
            }
            
            init() {
                if (this.container) return;
                
                this.container = document.createElement('div');
                this.container.id = 'test-notification-container';
                this.container.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    z-index: 1000;
                    max-width: 400px;
                `;
                document.body.appendChild(this.container);
            }
            
            show(message, type = 'info', duration = null) {
                this.init();
                
                const actualDuration = duration || this.defaultDuration;
                const toast = this.createToast(message, type, actualDuration);
                
                this.container.appendChild(toast);
                this.notifications.push(toast);
                
                if (this.notifications.length > this.maxNotifications) {
                    this.hide(this.notifications[0]);
                }
                
                requestAnimationFrame(() => {
                    toast.style.transform = 'translateX(0)';
                    toast.style.opacity = '1';
                });
                
                if (actualDuration > 0) {
                    setTimeout(() => {
                        this.hide(toast);
                    }, actualDuration);
                }
                
                return toast;
            }
            
            createToast(message, type, duration) {
                const toast = document.createElement('div');
                const colors = {
                    success: { bg: '#28a745', border: '#1e7e34' },
                    error: { bg: '#dc3545', border: '#c82333' },
                    warning: { bg: '#ffc107', border: '#e0a800' },
                    info: { bg: '#17a2b8', border: '#138496' }
                };
                
                const color = colors[type] || colors.info;
                
                toast.style.cssText = `
                    background: ${color.bg};
                    color: white;
                    padding: 12px 16px;
                    margin-bottom: 10px;
                    border-radius: 6px;
                    border-left: 4px solid ${color.border};
                    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                    transform: translateX(100%);
                    opacity: 0;
                    transition: all 0.3s ease;
                    font-family: Arial, sans-serif;
                    font-size: 14px;
                    word-wrap: break-word;
                `;
                
                toast.textContent = message;
                return toast;
            }
            
            hide(toast) {
                if (!toast || !toast.parentNode) return;
                
                toast.style.transform = 'translateX(100%)';
                toast.style.opacity = '0';
                
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.parentNode.removeChild(toast);
                    }
                    const index = this.notifications.indexOf(toast);
                    if (index > -1) {
                        this.notifications.splice(index, 1);
                    }
                }, 300);
            }
        }
        
        // –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è NotificationCenter –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        class TestNotificationCenter {
            constructor() {
                this.notifications = [];
                this.currentFilter = 'all';
                this.isModalOpen = false;
            }
            
            addNotification(notification) {
                const fullNotification = {
                    id: Date.now() + Math.random(),
                    ...notification,
                    created_at: new Date().toISOString(),
                    read: false
                };
                
                this.notifications.unshift(fullNotification);
                return fullNotification;
            }
            
            markAsRead(notificationId) {
                const notification = this.notifications.find(n => n.id === notificationId);
                if (notification) {
                    notification.read = true;
                }
            }
            
            markAllAsRead() {
                this.notifications.forEach(n => n.read = true);
            }
            
            updateBadges() {
                // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
                console.log('updateBadges called');
            }
        }
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        let testStats = {
            total: 0,
            passed: 0,
            failed: 0,
            warnings: 0
        };
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
        const TestNotificationManager = TestNotificationManager;
        const TestNotificationCenter = TestNotificationCenter;
        window.testNotificationManager = new TestNotificationManager();
        window.testNotificationCenter = new TestNotificationCenter();
        
        function updateStats() {
            document.getElementById('totalTests').textContent = testStats.total;
            document.getElementById('passedTests').textContent = testStats.passed;
            document.getElementById('failedTests').textContent = testStats.failed;
            document.getElementById('warningTests').textContent = testStats.warnings;
            
            const progress = testStats.total > 0 ? ((testStats.passed + testStats.failed + testStats.warnings) / testStats.total) * 100 : 0;
            document.getElementById('progressBar').style.width = progress + '%';
        }
        
        function addResult(message, type = 'info') {
            const results = document.getElementById('test-results');
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.innerHTML = `<strong>${new Date().toLocaleTimeString()}</strong>: ${message}`;
            results.appendChild(div);
            results.scrollTop = results.scrollHeight;
            
            if (type === 'success') testStats.passed++;
            else if (type === 'error') testStats.failed++;
            else if (type === 'warning') testStats.warnings++;
            
            updateStats();
            console.log(`[${type.toUpperCase()}] ${message}`);
        }
        
        function clearResults() {
            document.getElementById('test-results').innerHTML = '';
            testStats = { total: 0, passed: 0, failed: 0, warnings: 0 };
            updateStats();
        }
        
        function testToastNotification() {
            window.testNotificationManager.show('‚úÖ –¢–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç!', 'success');
            addResult('‚úÖ Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–∫–∞–∑–∞–Ω–æ —É—Å–ø–µ—à–Ω–æ', 'success');
        }
        
        function detectEnvironment() {
            const protocol = window.location.protocol;
            const hostname = window.location.hostname;
            
            if (protocol === 'file:') {
                return {
                    type: 'file',
                    canTestAPI: false,
                    message: '–õ–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª (file://)'
                };
            } else if (hostname === 'localhost' || hostname === '127.0.0.1') {
                return {
                    type: 'local',
                    canTestAPI: true,
                    message: '–õ–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä'
                };
            } else {
                return {
                    type: 'production',
                    canTestAPI: true,
                    message: '–ü—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä'
                };
            }
        }
        
        async function runStandaloneTests() {
            clearResults();
            const runBtn = document.getElementById('runTestsBtn');
            runBtn.disabled = true;
            runBtn.innerHTML = '‚è≥ –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤...';
            
            addResult('üöÄ –ù–∞—á–∏–Ω–∞–µ–º –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥—É–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π...', 'info');
            
            testStats.total = 15;
            updateStats();
            
            try {
                // –¢–µ—Å—Ç 1: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ä–µ–¥—ã
                addResult('1. üåç –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ä–µ–¥—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è...', 'info');
                const env = detectEnvironment();
                addResult(`‚úÖ –°—Ä–µ–¥–∞: ${env.message}`, 'success');
                
                if (!env.canTestAPI) {
                    addResult('‚ö†Ô∏è API —Ç–µ—Å—Ç—ã –±—É–¥—É—Ç –ø—Ä–æ–ø—É—â–µ–Ω—ã (file:// –ø—Ä–æ—Ç–æ–∫–æ–ª)', 'warning');
                }
                
                // –¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤
                addResult('2. üèóÔ∏è –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö –∫–ª–∞—Å—Å–æ–≤...', 'info');
                
                if (typeof TestNotificationManager !== 'undefined') {
                    addResult('‚úÖ TestNotificationManager –Ω–∞–π–¥–µ–Ω', 'success');
                } else {
                    addResult('‚ùå TestNotificationManager –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                }
                
                if (typeof TestNotificationCenter !== 'undefined') {
                    addResult('‚úÖ TestNotificationCenter –Ω–∞–π–¥–µ–Ω', 'success');
                } else {
                    addResult('‚ùå TestNotificationCenter –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                }
                
                // –¢–µ—Å—Ç 3: –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤
                addResult('3. üîß –¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤...', 'info');
                
                try {
                    const nm = new TestNotificationManager();
                    addResult('‚úÖ TestNotificationManager —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ', 'success');
                    
                    if (typeof nm.show === 'function') {
                        addResult('‚úÖ –ú–µ—Ç–æ–¥ show() –¥–æ—Å—Ç—É–ø–µ–Ω', 'success');
                    }
                } catch (error) {
                    addResult(`‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è TestNotificationManager: ${error.message}`, 'error');
                }
                
                try {
                    const nc = new TestNotificationCenter();
                    addResult('‚úÖ TestNotificationCenter —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ', 'success');
                    
                    if (typeof nc.addNotification === 'function') {
                        addResult('‚úÖ –ú–µ—Ç–æ–¥ addNotification() –¥–æ—Å—Ç—É–ø–µ–Ω', 'success');
                    }
                } catch (error) {
                    addResult(`‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è TestNotificationCenter: ${error.message}`, 'error');
                }
                
                // –¢–µ—Å—Ç 4: –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å NotificationCenter
                addResult('4. üìã –¢–µ—Å—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ NotificationCenter...', 'info');
                
                try {
                    const testNotification = {
                        title: '–¢–µ—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è',
                        message: '–≠—Ç–æ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ',
                        type: 'info'
                    };
                    
                    const notification = window.testNotificationCenter.addNotification(testNotification);
                    addResult('‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ', 'success');
                    
                    if (notification.id) {
                        addResult('‚úÖ ID —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è', 'success');
                    }
                    
                    window.testNotificationCenter.markAsRead(notification.id);
                    addResult('‚úÖ –û—Ç–º–µ—Ç–∫–∞ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ —Ä–∞–±–æ—Ç–∞–µ—Ç', 'success');
                    
                } catch (error) {
                    addResult(`‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è NotificationCenter: ${error.message}`, 'error');
                }
                
                // –¢–µ—Å—Ç 5: Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                addResult('5. üîî –¢–µ—Å—Ç Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π...', 'info');
                
                try {
                    window.testNotificationManager.show('–¢–µ—Å—Ç —É—Å–ø–µ—à–Ω—ã–π', 'success', 1000);
                    addResult('‚úÖ Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ (success) —Ä–∞–±–æ—Ç–∞–µ—Ç', 'success');
                    
                    setTimeout(() => {
                        window.testNotificationManager.show('–¢–µ—Å—Ç –æ—à–∏–±–∫–∏', 'error', 1000);
                        addResult('‚úÖ Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ (error) —Ä–∞–±–æ—Ç–∞–µ—Ç', 'success');
                    }, 500);
                    
                    setTimeout(() => {
                        window.testNotificationManager.show('–¢–µ—Å—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è', 'warning', 1000);
                        addResult('‚úÖ Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ (warning) —Ä–∞–±–æ—Ç–∞–µ—Ç', 'success');
                    }, 1000);
                    
                } catch (error) {
                    addResult(`‚ùå –û—à–∏–±–∫–∞ Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π: ${error.message}`, 'error');
                }
                
                // –¢–µ—Å—Ç 6: DOM –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏
                addResult('6. üéØ –¢–µ—Å—Ç DOM –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–π...', 'info');
                
                const testDiv = document.createElement('div');
                testDiv.id = 'test-element';
                testDiv.textContent = '–¢–µ—Å—Ç–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç';
                document.body.appendChild(testDiv);
                
                const foundElement = document.getElementById('test-element');
                if (foundElement) {
                    addResult('‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∏ –ø–æ–∏—Å–∫ DOM —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç', 'success');
                    foundElement.remove();
                } else {
                    addResult('‚ùå –ü—Ä–æ–±–ª–µ–º—ã —Å DOM –º–∞–Ω–∏–ø—É–ª—è—Ü–∏—è–º–∏', 'error');
                }
                
                // –¢–µ—Å—Ç 7: Local Storage
                addResult('7. üíæ –¢–µ—Å—Ç Local Storage...', 'info');
                
                try {
                    const testKey = 'notification_test_' + Date.now();
                    const testValue = 'test_value';
                    
                    localStorage.setItem(testKey, testValue);
                    const retrievedValue = localStorage.getItem(testKey);
                    
                    if (retrievedValue === testValue) {
                        addResult('‚úÖ Local Storage —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ', 'success');
                        localStorage.removeItem(testKey);
                    } else {
                        addResult('‚ùå Local Storage –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ', 'error');
                    }
                } catch (error) {
                    addResult(`‚ùå –û—à–∏–±–∫–∞ Local Storage: ${error.message}`, 'error');
                }
                
                // –¢–µ—Å—Ç 8: API (–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ)
                if (env.canTestAPI) {
                    addResult('8. üåê –¢–µ—Å—Ç API —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è...', 'info');
                    
                    try {
                        const response = await fetch('/api/health');
                        if (response.ok) {
                            const data = await response.json();
                            addResult(`‚úÖ API –¥–æ—Å—Ç—É–ø–Ω–æ: ${data.message}`, 'success');
                        } else {
                            addResult(`‚ö†Ô∏è API –≤–µ—Ä–Ω—É–ª–æ —Å—Ç–∞—Ç—É—Å ${response.status}`, 'warning');
                        }
                    } catch (error) {
                        addResult(`‚ùå –û—à–∏–±–∫–∞ API: ${error.message}`, 'error');
                    }
                } else {
                    addResult('8. üåê API —Ç–µ—Å—Ç—ã –ø—Ä–æ–ø—É—â–µ–Ω—ã (file:// –ø—Ä–æ—Ç–æ–∫–æ–ª)', 'warning');
                }
                
                // –§–∏–Ω–∞–ª—å–Ω–∞—è —Å–≤–æ–¥–∫–∞
                addResult('9. üìä –§–∏–Ω–∞–ª—å–Ω–∞—è —Å–≤–æ–¥–∫–∞...', 'info');
                
                const passRate = testStats.total > 0 ? ((testStats.passed / testStats.total) * 100).toFixed(1) : 0;
                const errorRate = testStats.total > 0 ? ((testStats.failed / testStats.total) * 100).toFixed(1) : 0;
                
                addResult(`üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: ${passRate}% —É—Å–ø–µ—à–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤, ${errorRate}% –æ—à–∏–±–æ–∫`, 'info');
                
                if (testStats.failed === 0) {
                    addResult('üéâ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ! –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç.', 'success');
                } else if (testStats.failed < 3) {
                    addResult('‚ö†Ô∏è –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏', 'warning');
                } else {
                    addResult('‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã', 'error');
                }
                
                if (!env.canTestAPI) {
                    addResult('üí° –î–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª —á–µ—Ä–µ–∑ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä', 'info');
                }
                
            } catch (error) {
                addResult(`‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: ${error.message}`, 'error');
            } finally {
                runBtn.disabled = false;
                runBtn.innerHTML = 'üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–µ —Ç–µ—Å—Ç—ã';
                addResult('üèÅ –ê–≤—Ç–æ–Ω–æ–º–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!', 'info');
            }
        }
        
        // –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            addResult('üìÑ –ê–≤—Ç–æ–Ω–æ–º–Ω–∞—è —Ç–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞', 'info');
            addResult('üí° –≠—Ç–∞ –≤–µ—Ä—Å–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π', 'info');
            
            const env = detectEnvironment();
            if (env.type === 'file') {
                addResult('‚ö†Ô∏è –î–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä', 'warning');
            }
        });
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
        window.addEventListener('error', (event) => {
            addResult(`‚ùå JavaScript –æ—à–∏–±–∫–∞: ${event.message}`, 'error');
        });
    </script>
</body>
</html>
